@app.route("/editar-perfil", methods=["GET", "POST"])
@login_required
def editar_perfil():
    # Obtener el perfil del usuario
    profile = Profile.query.filter_by(user_id=current_user.id).first()

    # Si el perfil no existe, créalo
    if not profile:
        profile = Profile(user_id=current_user.id, favorite_movie_genres=[])
        db.session.add(profile)
        db.session.commit()

    if request.method == "POST":
        # Obtener los valores del formulario
        selected_genres = request.form.getlist("favorite_movie_genres")

        # Actualizar el perfil del usuario con los géneros seleccionados
        profile.favorite_movie_genres = selected_genres
        db.session.commit()

        # Redirigir o mostrar un mensaje de éxito
        flash("Perfil actualizado con éxito", "success")
        return redirect(url_for("editar_perfil"))

    return render_template("editar_perfil.html", profile=profile)

